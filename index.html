<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NASA Space Registration Portal</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Animated stars background -->
    <div class="stars" id="stars"></div>
    
    <!-- Floating astronaut -->
    <div class="astronaut"></div>
    
    <!-- Planet decoration -->
    <div class="planet"></div>

    <div class="container">
        <div class="header">
            <h1 class="logo">NASA PORTAL</h1>
            <p class="subtitle">Join the next generation of space explorers</p>
        </div>

         <button class="register-btn" onclick="showRegistrationForm()">
            REGISTER FOR HACKATHON
        </button> 

        <div class="registration-form" id="registrationForm">
            <button class="close-btn" onclick="hideRegistrationForm()">&times;</button>
            <h2 class="form-title"> Hackathon Registration</h2>
            
            <form onsubmit="handleSubmit(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label for="firstName">First Name</label>
                        <input type="text" id="firstName" name="firstName" placeholder="Enter your first name" required>
                    </div>
                    <div class="form-group">
                        <label for="lastName">Last Name</label>
                        <input type="text" id="lastName" name="lastName" placeholder="Enter your last name" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" name="email" placeholder="astronaut@nasa.gov" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="tel" id="phone" name="phone" placeholder="+1 (555) 123-4567" required>
                    </div>
                    <div class="form-group">
                        <label for="age">Age</label>
                        <input type="number" id="age" name="age" min="18" max="65" placeholder="25" required>
                    </div>
                </div>

                 <div class="form-group">
    <label for="teamName">Team Name</label>
    <input type="text" id="teamName" name="teamName" placeholder="Enter your team's name" required>
</div>
<div class="form-group">
    <label for="member1">Member 1 (Team Lead)</label>
    <input type="text" id="member1" name="member1" placeholder="Enter full name of member 1" required>
</div>
<div class="form-group">
    <label for="member2">Member 2</label>
    <input type="text" id="member2" name="member2" placeholder="Enter full name of member 2">
</div>
<div class="form-group">
    <label for="member3">Member 3</label>
    <input type="text" id="member3" name="member3" placeholder="Enter full name of member 3">
</div>
<div class="form-group">
    <label for="member4">Member 4</label>
    <input type="text" id="member4" name="member4" placeholder="Enter full name of member 4">
</div>
                <!-- <div class="form-group">
                    <label for="mission">Preferred Mission</label>
                    <select id="mission" name="mission" required>
                        <option value="">Select a mission</option>
                        <option value="mars">Mars Exploration</option>
                        <option value="moon">Lunar Base Program</option>
                        <option value="iss">International Space Station</option>
                        <option value="asteroid">Asteroid Mining</option>
                        <option value="research">Space Research</option>
                    </select>
                </div> 

                 <div class="form-group">
                    <label for="experience">Space Experience</label>
                    <select id="experience" name="experience" required>
                        <option value="">Select your experience level</option>
                        <option value="none">No Experience</option>
                        <option value="basic">Basic Training</option>
                        <option value="intermediate">Intermediate</option>
                        <option value="advanced">Advanced</option>
                        <option value="expert">Expert Astronaut</option>
                    </select>
                </div> -->

                <button type="submit" class="submit-btn">
                     Register
                </button>
            </form>
        </div>
    </div>

    <script>
    // Create animated stars (no changes needed here)
    function createStars() {
        const starsContainer = document.getElementById('stars');
        const numStars = 100;
        for (let i = 0; i < numStars; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            star.style.left = Math.random() * 100 + '%';
            star.style.top = Math.random() * 100 + '%';
            star.style.animationDelay = Math.random() * 2 + 's';
            starsContainer.appendChild(star);
        }
    }

    function showRegistrationForm() {
        document.getElementById('registrationForm').classList.add('active');
    }

    function hideRegistrationForm() {
        document.getElementById('registrationForm').classList.remove('active');
    }

    // --- UPDATED FORM SUBMISSION LOGIC ---
    async function handleSubmit(event) {
        event.preventDefault(); // Prevent the form from reloading the page

        const form = event.target;
        const submitButton = form.querySelector('.submit-btn');
        submitButton.disabled = true; // Disable button to prevent multiple clicks
        submitButton.textContent = 'Submitting...';

        // Collect member names, filtering out any empty fields
        const members = [
            form.elements.member1.value,
            form.elements.member2.value,
            form.elements.member3.value,
            form.elements.member4.value,
        ].filter(member => member.trim() !== '');

        // Create a data object to send to the server
        const userData = {
            firstName: form.elements.firstName.value,
            lastName: form.elements.lastName.value,
            email: form.elements.email.value,
            phone: form.elements.phone.value,
            age: form.elements.age.value,
            teamName: form.elements.teamName.value,
            members: members,
        };

        try {
            // Send the data to your backend server
            const response = await fetch('http://localhost:3000/register', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(userData),
            });

            const result = await response.json();

            if (!response.ok) {
                // If server responds with an error, show it
                throw new Error(result.message || 'An unknown error occurred.');
            }

            // Show success message
            alert(`✅ Welcome, ${userData.firstName}! Your team "${userData.teamName}" has been registered successfully. Prepare for launch!`);
            
            form.reset();
            hideRegistrationForm();

        } catch (error) {
            // Show any error messages to the user
            console.error('Submission failed:', error);
            alert(`❌ Registration Failed: ${error.message}`);
        } finally {
            // Re-enable the submit button
            submitButton.disabled = false;
            submitButton.textContent = 'Register';
        }
    }

    // Initialize stars when page loads
    createStars();
</script>
</body>
</html>
